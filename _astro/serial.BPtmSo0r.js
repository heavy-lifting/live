import{P as A}from"./index.Dkgbun3A.js";var c={},x=!1;async function T(o,s){if(!x){if(x=!0,o in c)return c[o];if("serial"in navigator){const e=await navigator.serial.requestPort();await e.open({baudRate:s});const n=new TextEncoder,i=e.writable.getWriter();c[o]=function(u,a){const r=n.encode(u);if(!a)i.write(r);else{const f=new Uint8Array(4);f[0]=124,f[1]=a>>8&255,f[2]=a&255,f[3]=59;const t=new Uint8Array(r.length+4);t.set(r),t.set(f,r.length),i.write(t)}}}else throw"Webserial is not available in this browser."}}const P=.1;function W(o){const s=o.length;if(s==0)return 0;for(var e=65535,n=0;n<s;++n){e^=o.charCodeAt(n)<<8;for(var i=0;i<8;++i)e=(e&32768)>0?e<<1^4129:e<<1}return e&65535}A.prototype.serial=function(o=115200,s=!1,e=!1,n="default"){return this.withHap(i=>{n in c||T(n,o);const u=(a,r,f)=>{var t="",w=0;if(typeof r.value=="object")if("action"in r.value){var v=r.value.action;e&&(v=v.charAt(0)),t+=v+"(";var g=!0;for(var[l,b]of Object.entries(r.value))l!=="action"&&(g?g=!1:t+=",",e&&(l=l.charAt(0)),t+=l+":"+b);t+=")",s&&(w=W(t))}else for(const[h,y]of Object.entries(r.value))t+=`${h}:${y}`;else t=r.value;const d=(a-f+P)*1e3;window.setTimeout(function(){c[n](t,w)},d)};return i.setContext({...i.context,onTrigger:u,dominantTrigger:!0})})};export{T as getWriter};
